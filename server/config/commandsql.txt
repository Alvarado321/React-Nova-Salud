-- Script SQL para la base de datos de la botica Nova Salud
CREATE DATABASE IF NOT EXISTS nova_salud;
USE nova_salud;

-- Tabla de usuarios
CREATE TABLE IF NOT EXISTS usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    correo VARCHAR(255) NOT NULL UNIQUE,
    apellido_paterno VARCHAR(255) NOT NULL,
    apellido_materno VARCHAR(255),
    nombres VARCHAR(255) NOT NULL,
    contrasena VARCHAR(255) NOT NULL,
    fecha_creacion DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- Tabla de productos
CREATE TABLE IF NOT EXISTS productos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    descripcion VARCHAR(255),
    categoria VARCHAR(50),
    precio DECIMAL(10,2) NOT NULL,
    stock INT NOT NULL,
    proveedor VARCHAR(100),
    vencimiento DATE
);

-- Tabla de clientes
CREATE TABLE IF NOT EXISTS clientes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    apellido VARCHAR(100),
    dni VARCHAR(20),
    telefono VARCHAR(20),
    direccion VARCHAR(255)
);

-- Tabla de ventas
CREATE TABLE IF NOT EXISTS ventas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_cliente INT,
    fecha DATETIME DEFAULT CURRENT_TIMESTAMP,
    total DECIMAL(10,2),
    FOREIGN KEY (id_cliente) REFERENCES clientes(id)
);

-- Detalle de ventas
CREATE TABLE IF NOT EXISTS detalle_ventas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_venta INT,
    id_producto INT,
    cantidad INT,
    precio_unitario DECIMAL(10,2),
    FOREIGN KEY (id_venta) REFERENCES ventas(id),
    FOREIGN KEY (id_producto) REFERENCES productos(id)
);

-- Datos de ejemplo
INSERT INTO productos (nombre, descripcion, categoria, precio, stock, proveedor, vencimiento) VALUES
('Paracetamol', 'Analgésico y antipirético', 'Medicamento', 2.50, 20, 'Laboratorio A', '2025-12-31'),
('Ibuprofeno', 'Antiinflamatorio', 'Medicamento', 3.00, 10, 'Laboratorio B', '2026-06-30'),
('Alcohol en gel', 'Desinfectante', 'Higiene', 1.80, 50, 'Proveedor C', '2027-01-01');

INSERT INTO clientes (nombre, apellido, dni, telefono, direccion) VALUES
('Juan', 'Pérez', '12345678', '987654321', 'Av. Salud 123'),
('Ana', 'García', '87654321', '912345678', 'Calle Bienestar 456');

INSERT INTO ventas (id_cliente, total) VALUES (1, 5.00), (2, 3.00);
INSERT INTO detalle_ventas (id_venta, id_producto, cantidad, precio_unitario) VALUES
(1, 1, 2, 2.50),
(2, 2, 1, 3.00);
